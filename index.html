<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hakikat Kitabevi Sesli Yayınlar</title>
    <!-- Tailwind CSS CDN'i yüklüyor. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter yüklendi -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* Varsayılan tarayıcı stillerini sıfırlama ve özel fontu uygulama */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            /* Tema sınıfları JavaScript tarafından yönetileceği için burada başlangıç sınıfı kaldırıldı */
        }

        /* Oynatma hızı inputunun görünümünü özelleştirmek için */
        input[type='range']::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #059669; /* emerald-600 */
            cursor: pointer;
            box-shadow: 0 0 0 4px rgba(5, 150, 105, 0.3);
            transition: background .15s ease-in-out;
        }

        input[type='range']::-moz-range-thumb {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #059669; /* emerald-600 */
            cursor: pointer;
            box-shadow: 0 0 0 4px rgba(5, 150, 105, 0.3);
            transition: background .15s ease-in-out;
        }

        input[type='range']::-ms-thumb {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #059669; /* emerald-600 */
            cursor: pointer;
            box-shadow: 0 0 0 4px rgba(5, 150, 105, 0.3);
            transition: background .15s ease-in-out;
        }

        input[type='range']:focus::-webkit-slider-thumb {
            background: #047857; /* emerald-700 */
        }
        input[type='range']:focus::-moz-range-thumb {
            background: #047857; /* emerald-700 */
        }
        input[type='range']:focus::-ms-thumb {
            background: #047857; /* emerald-700 */
        }

        /* İlerleme çubuğunun dolgu rengi */
        input[type='range']#progress-bar {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            background: linear-gradient(to right, #059669 var(--progress, 0%), #d1d5db var(--progress, 0%)); /* green fill, gray background */
            border-radius: 9999px;
            outline: none;
            transition: background 450ms ease-in;
        }
        input[type='range']#progress-bar::-webkit-slider-runnable-track {
            background: transparent; /* Track color handled by parent input */
        }
        input[type='range']#progress-bar::-moz-range-track {
            background: transparent; /* Track color handled by parent input */
        }

        /* Kitap resmi seçimi için özel stil */
        .book-item {
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s;
            border: 3px solid transparent; /* Varsayılan olarak şeffaf kenarlık */
        }
        .book-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .book-item.selected {
            border-color: #059669; /* Seçili olduğunda yeşil kenarlık */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            transform: translateY(-2px);
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div id="player-card" class="bg-white bg-opacity-90 backdrop-filter backdrop-blur-lg rounded-2xl shadow-xl p-8 lg:p-6 w-full max-w-sm sm:max-w-lg md:max-w-4xl lg:max-w-6xl xl:max-w-7xl border border-gray-200 mx-auto">
        
        <!-- Üst Bölüm: Tema değiştirme, Logo ve Başlık -->
        <div class="relative flex flex-col items-center mb-4 lg:mb-2">
            <!-- Tema değiştirme düğmesi (absolute positioning) -->
            <div class="absolute top-0 right-0 z-10">
                <button id="theme-toggle" class="p-2 rounded-full bg-gray-200 hover:bg-gray-300 text-gray-800 transition-colors duration-200" aria-label="Temayı Değiştir">
                    <!-- Güneş ikonu (açık tema) -->
                    <svg id="sun-icon" class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 1.5a.5.5 0 00-.5.5v2a.5.5 0 001 0v-2a.5.5 0 00-.5-.5zM15.536 4.464a.5.5 0 00-.353.146l-1.414 1.414a.5.5 0 00.707.707l1.414-1.414a.5.5 0 00-.353-.853zM18.5 12a.5.5 0 00-.5-.5h-2a.5.5 0 000 1h2a.5.5 0 00.5-.5zM15.536 19.536a.5.5 0 00.353-.854l-1.414-1.414a.5.5 0 00-.707.707l1.414 1.414a.5.5 0 00.353.147zM12 22.5a.5.5 0 00.5-.5v-2a.5.5 0 00-1 0v2a.5.5 0 00.5.5zM8.464 19.536a.5.5 0 00.354-.147l1.414-1.414a.5.5 0 00-.707-.707l-1.414 1.414a.5.5 0 00.353.854zM5.5 12a.5.5 0 00-.5-.5h-2a.5.5 0 000 1h2a.5.5 0 00.5-.5zM8.464 4.464a.5.5 0 00-.353-.146l-1.414 1.414a.5.5 0 00.707.707l1.414-1.414a.5.5 0 00-.354-.853zM12 7a5 5 0 100 10 5 5 0 000-10z" />
                    </svg>
                    <!-- Ay ikonu (koyu tema) -->
                    <svg id="moon-icon" class="h-6 w-6 hidden" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 3a9 9 0 00-9 9 9 9 0 009 9 9 9 0 009-9A9 9 0 0012 3zm0 16.5V4.5a7.5 7.5 0 010 15z" />
                    </svg>
                </button>
            </div>

            <!-- Logo ve Başlık Grubu - Mobil ve Masaüstü için ortalanmış -->
            <div class="flex flex-col items-center sm:flex-row sm:space-x-2 mb-4 sm:mb-0 justify-center w-full">
                <img id="logo-image" src="https://www.huzurpinari.com/wp-content/uploads/2021/07/HP_Logo_Altin-2.png" alt="Huzur Pınarı Logo" class="w-40 h-10 sm:w-40 sm:h-10 mb-5 sm:mb-0">
                <h1 class="text-3xl sm:text-4xl font-extrabold text-center tracking-tight">
                    <span class="bg-clip-text text-transparent bg-gradient-to-r from-emerald-600 to-teal-700">
                        Hakikat Kitabevi Sesli Yayınlar
                    </span>
                </h1>
            </div>
        </div>

        <!-- Ana içerik alanı -->
        <div class="lg:flex lg:space-x-8 lg:items-start">
            <!-- Sol Bölüm: Kitap Seçimi (Görsel Liste) -->
            <div class="lg:w-1/2 flex flex-col mb-8 lg:mb-0">
                <label class="block text-gray-700 text-sm font-semibold mb-2">
                    Kitap Seçin:
                </label>
                <!-- Arama çubuğu eklendi -->
                <div class="mb-4">
                    <input type="text" id="search-input" placeholder="Kitap veya konu ara..." class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500">
                </div>
                <div id="book-images-container" class="flex flex-row lg:grid lg:grid-cols-3 gap-2 overflow-x-auto pb-4 lg:pb-0">
                    <!-- Kitap resimleri JavaScript tarafından doldurulacak -->
                </div>
            </div>

            <!-- Sağ Bölüm: Konu Seçimi, Oynatıcı Bilgisi ve Kontrolleri -->
            <div class="lg:w-1/2 flex flex-col">
                <!-- Yeni: Seçilen Kitap Resmi -->
                <div class="text-center mb-6">
                    <a id="current-book-image-link" href="#" target="_blank" rel="noopener noreferrer" class="inline-block mb-4 rounded-lg overflow-hidden shadow-lg transition-transform hover:scale-105">
                        <img id="current-book-display-image" src="" alt="Kitap Resmi" class="w-48 h-auto object-contain rounded-lg mx-auto">
                    </a>
                </div>

                <div class="mb-8 mt-6"> <!-- Konu Seçimi buraya taşındı -->
                    <label for="topic-select" class="block text-gray-700 text-sm font-semibold mb-2">
                        Konu Seçin:
                    </label>
                    <div class="relative">
                        <select id="topic-select" class="block appearance-none w-full bg-gray-100 border border-gray-300 text-gray-800 py-3 px-4 pr-8 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition duration-200 ease-in-out cursor-pointer">
                            <!-- Konu seçenekleri JavaScript tarafından doldurulacak -->
                        </select>
                        <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                            <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                                <path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 6.757 7.586 5.343 9z" />
                            </svg>
                        </div>
                    </div>
                </div>

               

                <audio id="audio-player" preload="auto" class="hidden"></audio>

                <!-- İlerleme çubuğu ve Oynat/Duraklat düğmesi grubu -->
                <div class="flex items-center gap-4 mb-6">
                    <!-- Oynat/Duraklat düğmesi -->
                    <button id="play-pause-btn" class="flex-shrink-0 flex items-center justify-center p-3 rounded-full bg-emerald-700 text-white shadow-lg hover:bg-emerald-800 focus:outline-none focus:ring-4 focus:ring-emerald-300 transition-all duration-300 ease-in-out transform hover:scale-105" aria-label="Oynat">
                        <!-- SVG Icons -->
                        <svg id="play-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M8 5v14l11-7z" />
                        </svg>
                        <svg id="pause-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z" />
                        </svg>
                    </button>
                    <!-- Progress bar ve zamanlar -->
                    <div class="flex flex-col flex-grow">
                        <input type="range" id="progress-bar" min="0" max="100" value="0" class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer accent-emerald-600 focus:outline-none focus:ring-2 focus:ring-emerald-500">
                        <div class="flex justify-between w-full text-gray-600 text-sm font-medium mt-1">
                            <span id="current-time">00:00</span>
                            <span id="duration">00:00</span>
                        </div>
                    </div>
                </div>

                <div class="mb-4">
                    <label for="playback-speed" class="block text-gray-700 text-sm font-semibold mb-2">
                        Oynatma Hızı: <span id="speed-value">1.0</span>x
                    </label>
                    <input type="range" id="playback-speed" min="1" max="3.0" step="0.25" value="1.0" class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer accent-emerald-600 focus:outline-none focus:ring-2 focus:ring-emerald-500">
                    <div class="flex justify-between w-full text-gray-600 text-xs mt-2">
                        <span>1.0x</span>
                        <span>1.5x</span>
                        <span>2.0x</span>
                        <span>2.5x</span>
                        <span>3.0x</span>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script>
        // Kitap verilerini doğrudan JavaScript içine gömdük
        const books = [
            {
                id: 'tam-tam-ilmihal',
                title: 'Tam İlmhal Seadet-i Ebediyye',
                imageUrl: 'https://www.hakikatkitabevi.net/images/books/B001.png',
                topics: [
                    { id: 'BİRİNCİ KISIM', title: '--BİRİNCİ KISIM--', audio: '' },
                    { id: '00 Giriş', title: '00 Giriş', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/00_Giris.mp3' },
                    { id: '00 Kitabda Bulunan Bilgiler', title: '00 Kitabda Bulunan Bilgiler', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/00_Kitabda_Bulunan_Bilgiler.mp3' },
                    { id: '00 Ön Kapak İçi', title: '00 Ön Kapak İçi', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/00_On_Kapak_Ici.mp3' },
                    { id: '00 Önsöz', title: '00 Önsöz', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/00_Onsoz.mp3.mp3' },
                    { id: '00 Tenbih', title: '00 Tenbih', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/00_Tenbih.mp3' },
                    { id: '01 Muhammed Aleyhisselama Uymak, Seadete Kavuşdurur', title: '01 Muhammed Aleyhisselama Uymak, Seadete Kavuşdurur', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/01_Muhammed_Aleyhisselama_Uymak,_Seadete_Kavusdurur.mp3' },
                    { id: '02 Allahü Tealaya İtaat İçin, Resûlüne İtaat Lazımdır', title: '02 Allahü Tealaya İtaat İçin, Resûlüne İtaat Lazımdır', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/02_Allahu_Tealaya_Itaat_Icin,_Resulune_Itaat_Lazimdir.mp3' },
                    { id: '03 Müsliman Olmak İçin Ne Yapmalı', title: '03 Müsliman Olmak İçin Ne Yapmalı', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/03_Musliman_Olmak_Icin_Ne_Yapmali.mp3' },
                    { id: '04 Ehli Sünnet Alimleri', title: '04 Ehli Sünnet Alimleri', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/04_Ehl-i_Sunnet_Alimleri.mp3' },
                    { id: '05 Ehli Sünnetin Reisi, İmamı Azam Ebu Hanifedir', title: '05 Ehli Sünnetin Reisi, İmamı Azam Ebu Hanifedir', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/05_Ehl-i_Sunnetin_Reisi,_Imam-i_Azam_Ebu_Hanifedir.mp3' },
                    { id: '06 İmamı Azamın Büyüklügü', title: '06 İmamı Azamın Büyüklügü', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/06_Imam-i_Azamin_Buyuklugu.mp3' },
                    { id: '07 İslam Alimlerinin Kitabları', title: '07 İslam Alimlerinin Kitabları', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/07_Islam_Alimlerinin_Kitablari.mp3' },
                    { id: '08 Uydurma Tefsir Yazan Kafir Olur', title: '08 Uydurma Tefsir Yazan Kafir Olur', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/08_Uydurma_Tefsir_Yazan_Kafir_Olur.mp3' },
                    { id: '09 Kuran Tercemelerinden Hangisine Güvenileceği', title: '09 Kuran Tercemelerinden Hangisine Güvenileceği', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/09_Kuran_Tercemelerinden_Hangisine_Guvenilecegi.mp3' },
                    { id: '10 Din Hırsızları', title: '10 Din Hırsızları', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/10_Din_Hirsizlari.mp3' },
                    { id: '11 İmanın Gitmesine Sebeb Olan Şeyler', title: '11 İmanın Gitmesine Sebeb Olan Şeyler', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/11_Imanin_Gitmesine_Sebeb_Olan_Seyler.mp3' },
                    { id: '12 Kalbde İman Bulunmasına Alamet', title: '12 Kalbde İman Bulunmasına Alamet', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/12_Kalbde_Iman_Bulunmasina_Alamet.mp3' },
                    { id: '13 Allahü Tealanın Nimetleri, Dünyada Herkesedir', title: '13 Allahü Tealanın Nimetleri, Dünyada Herkesedir', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/13_Allahu_Tealanin_Nimetleri,_Dunyada_Herkesedir.mp3' },
                    { id: '14 Ahıretde Kafire Merhamet Yokdur', title: '14 Ahıretde Kafire Merhamet Yokdur', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/14_Ahiretde_Kafire_Merhamet_Yokdur.mp3' },
                    { id: '15 Muhabbetin Alametleri', title: '15 Muhabbetin Alametleri', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/15_Muhabbetin_Alametleri.mp3' },
                    { id: '16 Muhammed Aleyhisselam, Allahü Tealanın Sevgilisidir', title: '16 Muhammed Aleyhisselam, Allahü Tealanın Sevgilisidir', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/16_Muhammed_Aleyhisselam,_Allahu_Tealanin_Sevgilisidir.mp3' },
                    { id: '17 Peygamberimizin Mucizeleri. Kuranı Kerimin Üstünlügü', title: '17 Peygamberimizin Mucizeleri. Kuranı Kerimin Üstünlügü', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/17_Peygamberimizin_Mucizeleri._Kuran-i_Kerimin_Ustunlugu.mp3' },
                    { id: '18 Resule Tabi Olmak Nasıl Olur', title: '18 Resule Tabi Olmak Nasıl Olur', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/18_Resule_Tabi_Olmak_Nasil_Olur.mp3' },
                    { id: '19 Hubbi Fillah, Buğdi Fillah. Kazaya Rıza Nasıl Olur', title: '19 Hubbi Fillah, Buğdi Fillah. Kazaya Rıza Nasıl Olur', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/19_Hubb-i_Fillah,_Bugd-i_Fillah._Kazaya_Riza_Nasil_Olur.mp3' },
                    { id: '20 Kafirler İki Kısmdır', title: '20 Kafirler İki Kısmdır', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/20_Kafirler_Iki_Kismdir.mp3' },
                    { id: '21 Cennete Girmek İçin', title: '21 Cennete Girmek İçin', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/21_Cennete_Girmek_Icin.mp3' },
                    { id: '22 Kafirlerin İyiliği Dünyada Kalır', title: '22 Kafirlerin İyiliği Dünyada Kalır', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/22_Kafirlerin_Iyiligi_Dunyada_Kalir.mp3' },
                    { id: '23 Dünya, Ahiretin Tarlasıdır', title: '23 Dünya, Ahiretin Tarlasıdır', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/23_Dunya,_Ahiretin_Tarlasidir.mp3' },
                    { id: '24 Ahiret Bilgileri, Aklın Dışındadır. Bunlara Akl Ermez', title: '24 Ahiret Bilgileri, Aklın Dışındadır. Bunlara Akl Ermez', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/24_Ahiret_Bilgileri,_Aklin_Disindadir._Bunlara_Akl_Ermez.mp3' },
                    { id: '25 Kuranı Kerim Nedir', title: '25 Kuranı Kerim Nedir', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/25_Kuran-i_Kerim_Nedir.mp3' },
                    { id: '26 İctihad Hataları. İmamı Azamın Büyüklüğü', title: '26 İctihad Hataları. İmamı Azamın Büyüklüğü', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/26_Ictihad_Hatalari._Imam-i_Azamin_Buyuklugu.mp3' },
                    { id: '27 İctihad Ne Demekdir', title: '27 İctihad Ne Demekdir', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/27_Ictihad_Ne_Demekdir.mp3' },
                    { id: '28 Sünneti Müekkede, Sünneti Zevaid', title: '28 Sünneti Müekkede, Sünneti Zevaid', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/28_Sunnet-i_Muekkede,_Sunnet-i_Zevaid.mp3' },
                    { id: '29 Kafirlerin Kullandığı Şeyler İki Dürlüdür', title: '29 Kafirlerin Kullandığı Şeyler İki Dürlüdür', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/29_Kafirlerin_Kullandigi_Seyler_Iki_Durludur.mp3' },
                    { id: '30 Resulullaha Uymak Yedi Derecedir', title: '30 Resulullaha Uymak Yedi Derecedir', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/30_Resulullaha_Uymak_Yedi_Derecedir.mp3' },
                    { id: '31 2.Cild 67.Mektub', title: '31 2.Cild 67.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/31_2.Cild_67.Mektub.mp3' },
                    { id: '32 3.Cild 38.Mektub', title: '32 3.Cild 38.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/32_3.Cild_38.Mektub.mp3' },
                    { id: '33 3.Cild 101.Mektub', title: '33 3.Cild 101.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/33_3.Cild_101.Mektub.mp3' },
                    { id: '34 2.Cild 19.Mektub', title: '34 2.Cild 19.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/34_2.Cild_19.Mektub.mp3' },
                    { id: '35 3.Cild 22.Mektub', title: '35 3.Cild 22.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/35_3.Cild_22.Mektub.mp3' },
                    { id: '36 Bir Üniversiteliye Cevab', title: '36 Bir Üniversiteliye Cevab', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/36_Bir_Universiteliye_Cevab.mp3' },
                    { id: '37 2.Cild 31.Mektub', title: '37 2.Cild 31.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/37_2.Cild_31.Mektub.mp3' },
                    { id: '38 2.Cild 89.Mektub', title: '38 2.Cild 89.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/38_2.Cild_89.Mektub.mp3' },
                    { id: '39 2.Cild 58.Mektub', title: '39 2.Cild 58.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/39_2.Cild_58.Mektub.mp3' },
                    { id: '40 3.Cild 31.Mektub', title: '40 3.Cild 31.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/40_3.Cild_31.Mektub.mp3' },
                    { id: '41 4.Cild 29.Mektub', title: '41 4.Cild 29.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/41_4.Cild_29.Mektub.mp3' },
                    { id: '42 2.Cild 81.Mektub', title: '42 2.Cild 81.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/42_2.Cild_81.Mektub.mp3' },
                    { id: '43 2.Cild 66.Mektub', title: '43 2.Cild 66.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/43_2.Cild_66.Mektub.mp3' },
                    { id: '44 2.Cild 82.Mektub', title: '44 2.Cild 82.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/44_2.Cild_82.Mektub.mp3' },
                    { id: '45 3.Cild 1.Mektub', title: '45 3.Cild 1.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/45_3.Cild_1.Mektub.mp3' },
                    { id: '46 3.Cild 17.Mektub', title: '46 3.Cild 17.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/46_3.Cild_17.Mektub.mp3' },
                    { id: '47 3.Cild 34.Mektub', title: '47 3.Cild 34.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/47_3.Cild_34.Mektub.mp3' },
                    { id: '48 3.Cild 35.Mektub', title: '48 3.Cild 35.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/48_3.Cild_35.Mektub.mp3' },
                    { id: '49 3.Cild 57.Mektub', title: '49 3.Cild 57.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/49_3.Cild_57.Mektub.mp3' },
                    { id: '50 Muhammed Masum Farukinin 1.Cild 14.Mektubu', title: '50 Muhammed Masum Farukinin 1.Cild 14.Mektubu', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/50_Muhammed_Masum_Farukinin_1.Cild_14.Mektubu.mp3' },
                    { id: '51 Beş Vakt Namaz', title: '51 Beş Vakt Namaz', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/51_Bes_Vakt_Namaz.mp3' },
                    { id: '52 Namazın Farzları (Abdest Almak)', title: '52 Namazın Farzları (Abdest Almak)', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/52_Namazin_Farzlari_(Abdest_Almak).mp3' },
                    { id: '53 Mest Üstüne Mesh, Özr Sahibi Olmak', title: '53 Mest Üstüne Mesh, Özr Sahibi Olmak', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/53_Mest_Ustune_Mesh,_Ozr_Sahibi_Olmak.mp3' },
                    { id: '54 Gusl Abdestii', title: '54 Gusl Abdestii', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/54_Gusl_Abdestii.mp3' },
                    { id: '55 Teyemmüm', title: '55 Teyemmüm', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/55_Teyemmum.mp3' },
                    { id: '56 Necasetden Taharet', title: '56 Necasetden Taharet', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/56_Necasetden_Taharet.mp3' },
                    { id: '57 Sular ve Çeşidleri', title: '57 Sular ve Çeşidleri', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/57_Sular_ve_Cesidleri.mp3' },
                    { id: '58 Setri Avret ve Kadınların Örtünmesi', title: '58 Setri Avret ve Kadınların Örtünmesi', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/58_Setri_Avret_ve_Kadinlarin_Ortunmesi.mp3' },
                    { id: '59 İstikbali Kıble', title: '59 İstikbali Kıble', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/59_Istikbali_Kible.mp3' },
                    { id: '60 Namaz Vaktleri', title: '60 Namaz Vaktleri', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/60_Namaz_Vaktleri.mp3' },
                    { id: '61 Ezan ve İkamet', title: '61 Ezan ve İkamet', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/61_Ezan_ve_Ikamet.mp3' },
                    { id: '62 1.Cild 303.Mektub', title: '62 1.Cild 303.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/62_1.Cild_303.Mektub.mp3' },
                    { id: '63 Namazın Ehemmiyyeti', title: '63 Namazın Ehemmiyyeti', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/63_Namazin_Ehemmiyyeti.mp3' },
                    { id: '64 Namaz Nasıl Kılınır', title: '64 Namaz Nasıl Kılınır', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/64_Namaz_Nasil_Kilinir.mp3' },
                    { id: '65 Yolculukda Namaz', title: '65 Yolculukda Namaz', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/65_Yolculukda_Namaz.mp3' },
                    { id: '66 Namazın Vacibleri, Secdei Sehv', title: '66 Namazın Vacibleri, Secdei Sehv', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/66_Namazin_Vacibleri,_Secdei_Sehv.mp3' },
                    { id: '67 Namazı Bozan Şeyler', title: '67 Namazı Bozan Şeyler', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/67_Namazi_Bozan_Seyler.mp3' },
                    { id: '68 Namazın Mekruhları', title: '68 Namazın Mekruhları', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/68_Namazin_Mekruhlari.mp3' },
                    { id: '69 Teravih Namazı ve Camilere Saygı', title: '69 Teravih Namazı ve Camilere Saygı', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/69_Teravih_Namazi_ve_Camilere_Saygi.mp3' },
                    { id: '70 Cemaat İle Namaz', title: '70 Cemaat İle Namaz', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/70_Cemaat_Ile_Namaz.mp3' },
                    { id: '71 Cuma Namazı', title: '71 Cuma Namazı', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/71_Cuma_Namazi.mp3' },
                    { id: '72 Bayram Namazları', title: '72 Bayram Namazları', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/72_Bayram_Namazlari.mp3' },
                    { id: '73 1.Cild 312.Mektub', title: '73 1.Cild 312.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/73_1.Cild_312.Mektub.mp3' },
                    { id: '74 Kaza Namazları', title: '74 Kaza Namazları', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/74_Kaza_Namazlari.mp3' },
                    { id: '75 2.Cild 20.Mektub', title: '75 2.Cild 20.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/75_2.Cild_20.Mektub.mp3' },
                    { id: '76 2.Cild 87.Mektub', title: '76 2.Cild 87.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/76_2.Cild_87.Mektub.mp3' },
                    { id: '77 2.Cild 69.Mektub', title: '77 2.Cild 69.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/77_2.Cild_69.Mektub.mp3' },
                    { id: '78 Zekat Vermek', title: '78 Zekat Vermek', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/78_Zekat_Vermek.mp3' },
                    { id: '79 Ramezan Orucu', title: '79 Ramezan Orucu', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/79_Ramezan_Orucu.mp3' },
                    { id: '80 Sadaka-ı Fıtr', title: '80 Sadaka-ı Fıtr', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/80_Sadaka-i_Fitr.mp3' },
                    { id: '81 Kurban Kesmek', title: '81 Kurban Kesmek', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/81_Kurban_Kesmek.mp3' },
                    { id: '82 Adak', title: '82 Adak', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/82_Adak.mp3' },
                    { id: '83 Yemin-Yemin Keffareti', title: '83 Yemin-Yemin Keffareti', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/83_Yemin-Yemin_Keffareti.mp3' },
                    { id: '84 Hacca Gitmek', title: '84 Hacca Gitmek', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/84_Hacca_Gitmek.mp3' },
                    { id: '85 Mubarek Geceler', title: '85 Mubarek Geceler', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/85_Mubarek_Geceler.mp3' },
                    { id: '86 Şemsi Seneleri, Kameri Seneye Çevirmek', title: '86 Şemsi Seneleri, Kameri Seneye Çevirmek', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/86_Semsi_Seneleri,_Kameri_Seneye_Cevirmek.mp3' },
                    { id: '87 Kameri Seneyi, Miladiye Çevirmek', title: '87 Kameri Seneyi, Miladiye Çevirmek', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/87_Kameri_Seneyi,_Miladiye_Cevirmek.mp3' },
                    { id: '88 Hicri Sene Başının Hangi Gün Olduğunu Bulmak', title: '88 Hicri Sene Başının Hangi Gün Olduğunu Bulmak', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/88_Hicri_Sene_Basinin_Hangi_Gun_Oldugunu_Bulmak.mp3' },
                    { id: '89 Herhangi Bir Arabi Ayın Birinci Gününü Bulmak (Işık Usulü)', title: '89 Herhangi Bir Arabi Ayın Birinci Gününü Bulmak (Işık Usulü)', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/89_Herhangi_Bir_Arabi_Ayin_Birinci_Gununu_Bulmak_(Isik_Usulu).mp3' },
                    { id: '90 Selamlaşmak', title: '90 Selamlaşmak', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/90_Selamlasmak.mp3' },
                    { id: '91 Kuranı Kerim, Allah Kelamıdır', title: '91 Kuranı Kerim, Allah Kelamıdır', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/91_Kurani_Kerim,_Allah_Kelamidir.mp3' },
                    { id: '92 İsa Aleyhisselam İnsan idi, Ona Tapılmaz', title: '92 İsa Aleyhisselam İnsan idi, Ona Tapılmaz', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/92_Isa_Aleyhisselam_Insan_idi,_Ona_Tapilmaz.mp3' },
                    { id: '93 İsa Aleyhisselam Peygamberdir, Ona Tapılmaz', title: '93 İsa Aleyhisselam Peygamberdir, Ona Tapılmaz', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/93_Isa_Aleyhisselam_Peygamberdir,_Ona_Tapilmaz.mp3' },
                    { id: '94 2.Cild, 9.Mektub', title: '94 2.Cild, 9.Mektub', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/94_2.Cild,_9.Mektub.mp3' },
                    { id: '95 Hilyei Seadet', title: '95 Hilyei Seadet', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/95_Hilyei_Seadet.mp3' },
                    { id: '96 Muhammed Aleyhisselamın Ahlakı', title: '96 Muhammed Aleyhisselamın Ahlakı', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/96_Muhammed_Aleyhisselamin_Ahlaki.mp3' },
                    { id: '97 Resulullahın Ana, Baba ve Dedeleri, Hep Mümin idi', title: '97 Resulullahın Ana, Baba ve Dedeleri, Hep Mümin idi', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/97_Resulullahin_Ana,_Baba_ve_Dedeleri,_Hep_Mumin_idi.mp3' },
                    { id: '98 Sübhane Rabbike Ayeti Kerimesi', title: '98 Sübhane Rabbike Ayeti Kerimesi', audio: 'https://www.hakikatkitabevi.com/turkce/Kitaplar/Tam_Ilmihal/1_Kisim/98_Subhane_Rabbike_Ayeti_Kerimesi.mp3' },
                    { id: 'İKİNCİ KISIM', title: '--İKİNCİ KISIM--', audio: '' },
                ],
            },
            {
                id: 'mektubat',
                title: 'Mektubat Tercemesi',
                imageUrl: 'https://www.hakikatkitabevi.net/images/books/B002.png',
                topics: [
                    { id: 'mektubat-248', title: '248. Mektub', audio: '8-mektubat/248_Mektub.mp3'},
                    { id: 'mektubat-249', title: '249. Mektub', audio: '8-mektubat/249_Mektub.mp3'},
                    { id: 'mektubat-250', title: '250. Mektub', audio: '8-mektubat/250_Mektub.mp3'},
                    { id: 'mektubat-251', title: '251. Mektub', audio: '8-mektubat/251_Mektub.mp3'},
                    { id: 'mektubat-252', title: '252. Mektub', audio: '8-mektubat/252_Mektub.mp3'},
                    { id: 'mektubat-253', title: '253. Mektub', audio: '8-mektubat/253_Mektub.mp3'},
                    { id: 'mektubat-254', title: '254. Mektub', audio: '8-mektubat/254_Mektub.mp3'},
                    { id: 'mektubat-255', title: '255. Mektub', audio: '8-mektubat/255_Mektub.mp3'},
                    { id: 'mektubat-256', title: '256. Mektub', audio: '8-mektubat/256_Mektub.mp3'},
                    { id: 'mektubat-257', title: '257. Mektub', audio: '8-mektubat/257_Mektub.mp3'},
                    { id: 'mektubat-258', title: '258. Mektub', audio: '8-mektubat/258_Mektub.mp3'},
                    { id: 'mektubat-259', title: '259. Mektub', audio: '8-mektubat/259_Mektub.mp3'},
                    { id: 'mektubat-260', title: '260. Mektub', audio: '8-mektubat/260_Mektub.mp3'}
                ]
            },
            {
                id: 'faideli-bilgiler',
                title: 'Faideli Bilgiler',
                imageUrl: 'https://www.hakikatkitabevi.net/images/books/B008.png',
                topics: [
                    { id: 'faideli-bilgiler-1', title: 'Konu 1', audio: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3' }
                ]
            },
            {
                id: 'hak-sozun-vesikalari',
                title: 'Hak Sözün Vesikaları',
                imageUrl: 'https://www.hakikatkitabevi.net/images/books/B009.png',
                topics: [
                    { id: 'hak-sozun-vesikalari-1', title: 'Konu 1', audio: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-7.mp3' }
                ]
            },
            {
                id: 'herkese-lazim-olan-iman',
                title: 'Herkese Lazım Olan İman',
                imageUrl: 'https://www.hakikatkitabevi.net/images/books/B010.png',
                topics: [
                    { id: 'herkese-lazim-olan-iman-1', title: 'Konu 1', audio: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-8.mp3' }
                ]
            },
            {
                id: 'islam-ahlaki',
                title: 'İslam Ahlakı',
                imageUrl: 'https://www.hakikatkitabevi.net/images/books/B003.png',
                topics: [
                        {id: '001_On_Kapak_Ici.mp3', title: '001 - Ön Kapak İçi', audio: '4-islam-ahlaki/001_On_Kapak_Ici.mp3'},
                        {id: '002_Kelime-i_Tenzih.mp3', title: '002 - Kelime-i Tenzih', audio: '4-islam-ahlaki/002_Kelime-i_Tenzih.mp3'},
                        {id: '003_Onsoz.mp3', title: '003 - Önsöz', audio: '4-islam-ahlaki/003_Onsoz.mp3'},
                        {id: '004_1.Kisim.mp3', title: '004 - 1. Kısım', audio: '4-islam-ahlaki/004_1.Kisim.mp3'},
                        {id: '005_Kotu_Ahlak_ve_Bunlardan_Kurtulma_Careleri.mp3', title: '005 - Kötü Ahlâk ve Bunlardan Kurtulma Çareleri', audio: '4-islam-ahlaki/005_Kotu_Ahlak_ve_Bunlardan_Kurtulma_Careleri.mp3'},
                        {id: '006_Kotu_Ahlak_ve_Ilaclari.mp3', title: '006 - Kötü Ahlâk ve İlaclari', audio: '4-islam-ahlaki/006_Kotu_Ahlak_ve_Ilaclari.mp3'},
                        {id: '007_Kufr.mp3', title: '007 - Küfr', audio: '4-islam-ahlaki/007_Kufr.mp3'},
                        {id: '008_Cehalet.mp3', title: '008 - Cehalet', audio: '4-islam-ahlaki/008_Cehalet.mp3'},
                        {id: '009_Mal_Mevki_Hirsi.mp3', title: '009 - Mal Mevki Hırsı', audio: '4-islam-ahlaki/009_Mal_Mevki_Hirsi.mp3'},
                        {id: '010_Ayblanmak_Korkusu.mp3', title: '010- Ayblanmak Korkusu', audio: '4-islam-ahlaki/010_Ayblanmak_Korkusu.mp3'}
                ]
            },
            {
                id: 'eshab-i-kiram',
                title: 'Eshab-ı Kiram',
                imageUrl: 'https://www.hakikatkitabevi.net/images/books/B007.png',
                topics: [
                    { id: 'eshab-i-kiram-1', title: 'Konu 1', audio: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-10.mp3' }
                ]
            },
            {
                id: 'kiyamet-ve-ahiret',
                title: 'Kıyamet ve Ahiret',
                imageUrl: 'https://www.hakikatkitabevi.net/images/books/B004.png',
                topics: [
                    { id: 'kiyamet-ve-ahiret-1', title: 'Konu 1', audio: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3' }
                ]
            },
            {
                id: 'cevab-veremedi',
                title: 'Cevab Veremedi',
                imageUrl: 'https://www.hakikatkitabevi.net/images/books/B006.png',
                topics: [
                    { id: 'cevab-veremedi-1', title: 'Konu 1', audio: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3' }
                ]
            },
            {
                id: 'ingiliz-casusunun-itiraflari',
                title: 'İngiliz Casusunun İtirafı',
                imageUrl: 'https://www.hakikatkitabevi.net/images/books/B011.png',
                topics: [
                    { id: 'ingiliz-casusunun-itiraflari-1', title: 'Konu 1', audio: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3' }
                ]
            },
            {
                id: 'kiymetsiz-yazilar',
                title: 'Kıymetsiz Yazılar',
                imageUrl: 'https://www.hakikatkitabevi.net/images/books/B012.png',
                topics: [
                    { id: 'kiymetsiz-yazilar', title: 'Konu 1', audio: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3' }
                ]
            },
            {
                id: 'namaz-kitabi',
                title: 'Namaz Kitabı',
                imageUrl: 'https://www.hakikatkitabevi.net/images/books/B005.png',
                topics: [
                    { id: 'namaz-kitabi-1', title: 'Namazın Farzları', audio: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3' }
                ]
            },
            {
                id: 'sevahid-un-nubuvve',
                title: 'Şevahid-ün Nübüvve',
                imageUrl: 'https://www.hakikatkitabevi.net/images/books/B014.png',
                topics: [
                    { id: 'sevahid-un-nubuvve-1', title: 'Konu 1', audio: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3' }
                ]
            },
            {
                id: 'menakib-i-cihar-yar-i-guzin',
                title: 'Menakıb-ı Çihar Yar-i Güzin',
                imageUrl: 'https://www.hakikatkitabevi.net/images/books/B013.png',
                topics: [
                    { id: 'menakib-i-cihar-yar-i-guzin-1', title: 'Hazret-i Ali', audio: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3' }
                ]
            }
        ];

        // DOM elementlerini seç
        const bookImagesContainer = document.getElementById('book-images-container');
        const topicSelect = document.getElementById('topic-select');
        const currentTopicTitle = document.getElementById('current-topic-title');
        const visualProgressBar = document.getElementById('visual-progress-bar');
        const bookCompletionPercentage = document.getElementById('book-completion-percentage');
        const bookListenCount = document.getElementById('book-listen-count');
        const audioPlayer = document.getElementById('audio-player');
        const progressBar = document.getElementById('progress-bar');
        const currentTimeSpan = document.getElementById('current-time');
        const durationSpan = document.getElementById('duration');
        const playPauseBtn = document.getElementById('play-pause-btn');
        const playIcon = document.getElementById('play-icon');
        const pauseIcon = document.getElementById('pause-icon');
        const playbackSpeedInput = document.getElementById('playback-speed');
        const speedValueSpan = document.getElementById('speed-value');
        const currentBookDisplayImage = document.getElementById('current-book-display-image');
        const currentBookImageLink = document.getElementById('current-book-image-link');
        const searchInput = document.getElementById('search-input'); // Yeni arama inputu
        const resetProgressBtn = document.getElementById('reset-progress-btn'); // İlerleme Sıfırla düğmesi
        const progressBarContainer = document.getElementById('progress-bar-container');


        // Tema elementleri
        const themeToggleBtn = document.getElementById('theme-toggle');
        const sunIcon = document.getElementById('sun-icon');
        const moonIcon = document.getElementById('moon-icon');
        const playerCard = document.getElementById('player-card');

        // Durum değişkenleri
        let selectedBook = null;
        let currentTopic = null;
        let isPlaying = false;
        let playbackSpeed = parseFloat(playbackSpeedInput.value);

        // Kullanıcıya özel ilerleme verileri için global değişken
        let bookProgressData = {}; 

        // Yardımcı fonksiyon: Zamanı HH:MM:SS formatına dönüştürür
        function formatTime(seconds) {
            if (isNaN(seconds)) return '00:00';
            const h = Math.floor(seconds / 3600);
            const m = Math.floor((seconds % 3600) / 60);
            const s = Math.floor(seconds % 60);
            const formattedH = h > 0 ? String(h).padStart(2, '0') + ':' : '';
            const formattedM = String(m).padStart(2, '0');
            const formattedS = String(s).padStart(2, '0');
            return `${formattedH}${formattedM}:${formattedS}`;
        }

        // İlerleme verilerini localStorage'dan yükler veya başlatır
        function initializeProgressData() {
            const storedProgress = localStorage.getItem('bookProgress');
            if (storedProgress) {
                // Depolanan veriyi ayrıştır ve completedTopics dizilerini Set'lere dönüştür
                const parsedProgress = JSON.parse(storedProgress);
                for (const bookId in parsedProgress) {
                    if (parsedProgress.hasOwnProperty(bookId)) {
                        parsedProgress[bookId].completedTopics = new Set(parsedProgress[bookId].completedTopics);
                    }
                }
                bookProgressData = parsedProgress;
            } else {
                // Veri yoksa tüm kitaplar için başlat
                books.forEach(book => {
                    bookProgressData[book.id] = {
                        completedTopics: new Set(),
                        listenCount: 0
                    };
                });
                saveProgressData(); // Başlangıç durumunu kaydet
            }
        }

        // İlerleme verilerini localStorage'a kaydeder
        function saveProgressData() {
            // Set'leri JSON serileştirmesi için dizilere dönüştür
            const dataToStore = {};
            for (const bookId in bookProgressData) {
                if (bookProgressData.hasOwnProperty(bookId)) {
                    dataToStore[bookId] = {
                        completedTopics: Array.from(bookProgressData[bookId].completedTopics),
                        listenCount: bookProgressData[bookId].listenCount
                    };
                }
            }
            localStorage.setItem('bookProgress', JSON.stringify(dataToStore));
        }

        // En son oynatılan kitabın ve konunun durumunu kaydetme
        function saveLastPlayedState() {
            if (selectedBook && currentTopic && !isNaN(audioPlayer.currentTime)) {
                localStorage.setItem('lastPlayedBookId', selectedBook.id);
                localStorage.setItem('lastPlayedTopicId', currentTopic.id);
                localStorage.setItem('lastPlayedTime', audioPlayer.currentTime.toString());
            }
        }

        // Kitap resimlerini doldurma fonksiyonu (arama sorgusu eklenmiştir)
        function populateBookImages(searchTerm = '') {
            bookImagesContainer.innerHTML = ''; // Önceki resimleri temizle
            const lowerCaseSearchTerm = searchTerm.toLowerCase();

            // Kitapları ve konularını arama terimine göre filtrele
            const filteredBooks = books.filter(book => {
                const matchesBookTitle = book.title.toLowerCase().includes(lowerCaseSearchTerm);
                const matchesTopic = book.topics.some(topic => 
                    // topic ve topic.title'ın undefined/null olup olmadığını kontrol et
                    topic && topic.title && topic.title.toLowerCase().includes(lowerCaseSearchTerm)
                );
                return matchesBookTitle || matchesTopic;
            });

            filteredBooks.forEach(book => {
                const bookItem = document.createElement('div');
                bookItem.id = `book-item-${book.id}`; // Her kitaba özel ID
                // Kitap öğelerinin genişliğini küçülttük ve lg:grid-cols-3 ile her satırda 3 kitap olmasını sağladık
                bookItem.classList.add('book-item', 'flex-shrink-0', 'w-28', 'h-auto', 'rounded-lg', 'overflow-hidden', 'shadow-md', 'flex', 'flex-col', 'items-center', 'justify-center', 'p-2', 'bg-gray-50', 'text-center', 'transform', 'hover:scale-105', 'active:scale-95', 'duration-200', 'ease-in-out');
                bookItem.classList.add('lg:w-40', 'lg:h-auto', 'lg:p-3'); // Masaüstü için daha uygun boyutlandırma


                const img = document.createElement('img');
                img.src = book.imageUrl;
                img.alt = book.title;
                img.classList.add('w-20', 'h-20', 'object-contain', 'rounded-md', 'mb-2'); // Küçük resim boyutu
                img.classList.add('lg:w-32', 'lg:h-32'); // Masaüstü için daha büyük resim

                const title = document.createElement('p');
                title.textContent = book.title;
                // `truncate` kaldırıldı, böylece metin taşarsa alt satıra geçebilir
                title.classList.remove('truncate');
                title.classList.add('text-sm', 'font-semibold', 'text-gray-800', 'w-full'); // Başlık metni
                title.classList.add('lg:text-base');

                bookItem.appendChild(img);
                bookItem.appendChild(title);

                bookItem.addEventListener('click', () => {
                    // Mevcut oynatma durumunu kaydetmeden yeni kitaba geçiş yap
                    saveLastPlayedState(); 
                    selectBook(book.id);
                });

                bookImagesContainer.appendChild(bookItem);
            });
            // Tema geçişinde `book-item`'ların doğru arka plan rengini almasını sağla
            applyTheme(localStorage.getItem('theme') || 'dark');
        }

        // Kitap seçme ve UI'ı güncelleme fonksiyonu
        function selectBook(bookId) {
            const previouslySelected = document.querySelector('.book-item.selected');
            if (previouslySelected) {
                previouslySelected.classList.remove('selected');
                // Önceki seçili öğenin kenarlığını şeffaf yap
                previouslySelected.classList.remove('border-emerald-600');
                previouslySelected.classList.add('border-transparent');
            }

            const newSelectedBookElement = document.getElementById(`book-item-${bookId}`);
            if (newSelectedBookElement) {
                newSelectedBookElement.classList.add('selected');
                // Yeni seçili öğeye kenarlık ekle
                newSelectedBookElement.classList.remove('border-transparent');
                newSelectedBookElement.classList.add('border-emerald-600');
            }
            
            selectedBook = books.find(b => b.id === bookId);
            if (selectedBook) {
                // Konu seçme menüsünü doldur
                populateTopics(selectedBook.id);
                // Kitap görselini ve linkini güncelle
                currentBookDisplayImage.src = selectedBook.imageUrl;
                currentBookDisplayImage.alt = selectedBook.title;
                currentBookImageLink.href = selectedBook.imageUrl; // Kitap resmine tıklayınca resmin linkine gitsin

                // İlk konuyu yükle, otomatik oynatma yapma
                loadTopic(selectedBook.topics[0], false); 
                updateDisplay(); // Yeni kitap seçildiğinde ilerlemeyi güncelle
            }
        }

        // Konuları doldurma fonksiyonu
        function populateTopics(bookId) {
            const book = books.find(b => b.id === bookId);
            if (!book) return;

            topicSelect.innerHTML = ''; // Önceki seçenekleri temizle
            book.topics.forEach(topic => {
                const option = document.createElement('option');
                option.value = topic.id;
                option.textContent = topic.title;
                topicSelect.appendChild(option);
            });
            // Varsayılan olarak seçili kitabın ilk konusunu seç
            currentTopic = book.topics[0];
            topicSelect.value = currentTopic.id;
            // updateDisplay zaten selectBook içinde çağrılıyor
        }

        // Oynatma ekranını güncelle
        function updateDisplay() {
            if (currentTopic && selectedBook) {
                currentTopicTitle.textContent = currentTopic.title;
                
                const bookProgress = bookProgressData[selectedBook.id];
                const totalTopics = selectedBook.topics.length;
                const completedTopicsCount = bookProgress ? bookProgress.completedTopics.size : 0;
                let completionPercentage = 0;

                if (totalTopics > 0) {
                    completionPercentage = (completedTopicsCount / totalTopics) * 100;
                }

                const listenCount = bookProgress ? bookProgress.listenCount : 0;

                // İlerleme çubuğunu ve yüzdesini güncelle
                visualProgressBar.style.width = `${completionPercentage.toFixed(0)}%`;
                bookCompletionPercentage.textContent = `${completionPercentage.toFixed(0)}%`;
                
                // Dinleme sayacını güncelle
                bookListenCount.textContent = `Kitap Dinleme Sayısı: ${listenCount}`;

                // Sayfa başlığını güncelle
                document.title = `${selectedBook.title} - ${currentTopic.title} | Hakikat Kitabevi`;

            } else {
                currentTopicTitle.textContent = 'Konu Seçilmedi';
                visualProgressBar.style.width = '0%';
                bookCompletionPercentage.textContent = '0%';
                bookListenCount.textContent = 'Kitap Dinleme Sayısı: 0';
                document.title = 'Hakikat Kitabevi Sesli Yayınlar'; // Varsayılan başlık
            }
        }

        // Sesi yükleme ve oynatma
        function loadTopic(topic, autoPlayAfterLoad = false, seekTime = 0) {
            if (audioPlayer.src !== topic.audio) { // Sadece farklı bir ses ise yeniden yükle
                // Yeni bir konu yüklendiğinde mevcut oynatma durumunu kaydet
                if (selectedBook && currentTopic) {
                    saveLastPlayedState();
                }

                audioPlayer.src = topic.audio;
                audioPlayer.load(); // Ses dosyasını yükle
                isPlaying = false; // Yükleme sırasında oynatmıyor olarak ayarla
                updatePlayPauseButton();
                progressBar.value = 0;
                currentTimeSpan.textContent = '00:00';
                durationSpan.textContent = '00:00';
                progressBar.style.setProperty('--progress', '0%');
            }

            currentTopic = topic;
            updateDisplay(); // Sayfa başlığını burada da güncelle
            audioPlayer.playbackRate = playbackSpeed; // Hızı uygula

            // Eğer bir seekTime belirtildiyse, ses yüklenince o zamana git
            audioPlayer.oncanplaythrough = () => {
                if (seekTime > 0 && !audioPlayer.seeking) {
                    audioPlayer.currentTime = seekTime;
                    audioPlayer.oncanplaythrough = null; // Sadece bir kez çalıştır
                }
                if (autoPlayAfterLoad) {
                    audioPlayer.play().catch(e => {
                        console.error("Oynatma hatası (otomatik geçiş):", e);
                        isPlaying = false;
                        updatePlayPauseButton();
                    });
                    isPlaying = true;
                    updatePlayPauseButton();
                }
            };
        }

        // Oynat/Duraklat düğmesi ikonunu güncelle
        function updatePlayPauseButton() {
            if (isPlaying) {
                playIcon.classList.add('hidden');
                pauseIcon.classList.remove('hidden');
                playPauseBtn.setAttribute('aria-label', 'Duraklat');
            } else {
                playIcon.classList.remove('hidden');
                pauseIcon.classList.add('hidden');
                playPauseBtn.setAttribute('aria-label', 'Oynat');
            }
        }

        // Tema uygulama fonksiyonu
        function applyTheme(theme) {
            const body = document.body;
            
            // Mevcut arka plan sınıflarını temizle
            body.classList.remove('bg-gradient-to-br', 'from-gray-800', 'via-stone-900', 'to-black', 'from-blue-100', 'via-white', 'to-gray-200');
            // playerCard'ın önceki tema sınıflarını temizle
            playerCard.classList.remove('bg-white', 'bg-opacity-90', 'backdrop-blur-lg', 'bg-gray-100', 'bg-opacity-95', 'border-gray-700', 'border-gray-200', 'bg-gray-800');

            // Metin renklerini ve diğer tema özelliklerini güncelle
            const textElements = document.querySelectorAll('label, h1, h2, p, span, .book-item p'); // book-item içindeki p etiketleri de dahil edildi
            textElements.forEach(el => {
                // Eski metin rengi sınıflarını temizle
                el.classList.remove('text-gray-800', 'text-gray-700', 'text-gray-600', 'text-white', 'text-gray-200');
                if (theme === 'dark') {
                    el.classList.add('text-gray-200'); // Koyu temada açık metin
                } else {
                    el.classList.add('text-gray-800'); // Açık temada koyu metin
                }
            });

            // Kitap tamamlama yüzdesi metin rengini temaya göre ayarla
            const bookCompletionPercentageWrapper = document.getElementById('book-completion-percentage-wrapper');
            if (bookCompletionPercentageWrapper) {
                bookCompletionPercentageWrapper.classList.remove('text-gray-800', 'text-gray-200'); // Mevcut renkleri temizle
                if (theme === 'dark') {
                    bookCompletionPercentageWrapper.classList.add('text-gray-200'); // Koyu temada açık metin (koyu çubuk üzerinde okunabilir)
                } else {
                    bookCompletionPercentageWrapper.classList.add('text-gray-800'); // Açık temada koyu metin (açık çubuk üzerinde okunabilir)
                }
            }
            
            // Kitap ilerlemesi çubuğunun arka planını temaya göre ayarla (progressBarContainer üzerinden)
            if (progressBarContainer) { // progressBarContainer'ın varlığını kontrol et
                progressBarContainer.classList.remove('bg-gray-200', 'bg-gray-700'); // Mevcut renkleri temizle
                if (theme === 'dark') {
                    progressBarContainer.classList.add('bg-gray-700'); // Koyu temada koyu arka plan
                } else {
                    progressBarContainer.classList.add('bg-gray-200'); // Açık temada açık arka plan
                }
            }


            // İlerleme sıfırlama düğmesi rengini temaya göre ayarla
            if (resetProgressBtn) {
                resetProgressBtn.classList.remove('bg-red-600', 'hover:bg-red-700', 'bg-red-700', 'hover:bg-red-800');
                if (theme === 'dark') {
                    resetProgressBtn.classList.add('bg-red-700', 'hover:bg-red-800');
                } else {
                    resetProgressBtn.classList.add('bg-red-600', 'hover:bg-red-700');
                }
            }


            // Input, select ve arama inputu elementlerinin arka plan ve metin renklerini güncelle
            const inputSelectElements = document.querySelectorAll('select, input[type="range"], input[type="text"]');
            inputSelectElements.forEach(el => {
                // Eski arka plan ve metin rengi sınıflarını temizle
                el.classList.remove('bg-gray-100', 'text-gray-800', 'bg-gray-700', 'text-gray-100', 'border-gray-300', 'border-gray-600', 'bg-white');
                if (theme === 'dark') {
                    el.classList.add('bg-gray-700', 'text-gray-100', 'border-gray-600'); // Koyu temada koyu input/select, açık metin ve koyu kenarlık
                } else {
                    el.classList.add('bg-white', 'text-gray-800', 'border-gray-300'); // Açık temada beyaz input/select, koyu metin ve açık kenarlık
                }
            });
            // Arama çubuğunun kenarlık rengini de güncelle
            const searchInput = document.getElementById('search-input');
            if (searchInput) {
                searchInput.classList.remove('border-gray-300', 'border-gray-600');
                if (theme === 'dark') {
                    searchInput.classList.add('border-gray-600');
                } else {
                    searchInput.classList.add('border-gray-300');
                }
            }


            if (theme === 'dark') {
                body.classList.add('bg-gradient-to-br', 'from-gray-800', 'via-stone-900', 'to-black');
                playerCard.classList.add('bg-gray-800', 'bg-opacity-90', 'backdrop-blur-lg', 'border-gray-700'); // Koyu tema için card arka planı ve kenarlık
                themeToggleBtn.classList.remove('bg-gray-200', 'hover:bg-gray-300', 'text-gray-800');
                themeToggleBtn.classList.add('bg-gray-700', 'hover:bg-gray-600', 'text-white');
                sunIcon.classList.remove('hidden');
                moonIcon.classList.add('hidden');
            } else { // light theme
                body.classList.add('bg-gradient-to-br', 'from-blue-100', 'via-white', 'to-gray-200');
                playerCard.classList.add('bg-white', 'bg-opacity-95', 'backdrop-blur-lg', 'border-gray-200'); // Açık tema için card arka planı ve kenarlık
                themeToggleBtn.classList.remove('bg-gray-700', 'hover:bg-gray-600', 'text-white');
                themeToggleBtn.classList.add('bg-gray-200', 'hover:bg-gray-300', 'text-gray-800');
                sunIcon.classList.add('hidden');
                moonIcon.classList.remove('hidden');
            }
            localStorage.setItem('theme', theme);

            // book-item elemanlarının arka planını ve kenarlıklarını güncelle
            document.querySelectorAll('.book-item').forEach(item => {
                item.classList.remove('bg-gray-50', 'bg-gray-700', 'border-transparent', 'border-emerald-600', 'bg-white');
                if (theme === 'dark') {
                    item.classList.add('bg-gray-700'); // Koyu tema kitap öğesi arka planı
                } else {
                    item.classList.add('bg-white'); // Açık tema kitap öğesi arka planı (Tamamen beyaz)
                }
                // Seçili kitap öğesinin kenarlık rengini koru
                if (item.classList.contains('selected')) {
                    item.classList.add('border-emerald-600');
                } else {
                    item.classList.add('border-transparent');
                }
            });
        }

        // Olay Dinleyicileri

        // Sayfa yüklendiğinde
        window.onload = () => {
            // Kaydedilmiş temayı yükle veya varsayılan olarak koyu temayı kullan
            let currentTheme = localStorage.getItem('theme') || 'dark';
            applyTheme(currentTheme);
            
            initializeProgressData(); // İlerleme verilerini başlat
            populateBookImages(); // Kitap seçim elemanlarını doldur

            // En son oynatılan durumu kontrol et ve yükle
            const lastPlayedBookId = localStorage.getItem('lastPlayedBookId');
            const lastPlayedTopicId = localStorage.getItem('lastPlayedTopicId');
            const lastPlayedTime = parseFloat(localStorage.getItem('lastPlayedTime')) || 0;

            if (lastPlayedBookId && lastPlayedTopicId) {
                const book = books.find(b => b.id === lastPlayedBookId);
                if (book) {
                    selectBook(book.id); // Kitabı seç
                    const topic = book.topics.find(t => t.id === lastPlayedTopicId);
                    if (topic) {
                        topicSelect.value = topic.id; // Konuyu seçili hale getir
                        loadTopic(topic, false, lastPlayedTime); // Konuyu yükle ve kaldığı yerden devam et
                        console.log(`Kaldığı yerden devam ediliyor: Kitap "${book.title}", Konu "${topic.title}", Süre: ${formatTime(lastPlayedTime)}`);
                    } else {
                        // Eğer konu bulunamazsa, kitabın ilk konusunu yükle
                        loadTopic(book.topics[0], false);
                    }
                } else {
                    // Eğer kitap bulunamazsa veya hiç kaydedilen durum yoksa, ilk kitabı seç
                    if (books.length > 0) {
                        selectBook(books[0].id);
                    }
                }
            } else {
                // Hiç kaydedilen durum yoksa, ilk kitabı seç
                if (books.length > 0) {
                    selectBook(books[0].id);
                }
            }
        };

        // Konu seçimi değiştiğinde
        topicSelect.addEventListener('change', (event) => {
            const topicId = event.target.value;
            const topic = selectedBook.topics.find(t => t.id === topicId);
            if (topic) {
                // Yeni konu seçildiğinde mevcut oynatma durumunu kaydet
                saveLastPlayedState();
                loadTopic(topic, false); // Seçilen konuyu yükle, otomatik oynatma yapma
            }
        });

        // Arama çubuğuna yazıldığında kitapları filtrele
        searchInput.addEventListener('input', (event) => {
            const searchTerm = event.target.value;
            populateBookImages(searchTerm);
        });

        // Oynat/Duraklat düğmesi tıklaması
        playPauseBtn.addEventListener('click', () => {
            if (audioPlayer.paused) {
                audioPlayer.play().then(() => {
                    isPlaying = true;
                    updatePlayPauseButton();
                }).catch(e => {
                    console.error("Oynatma hatası (manuel):", e);
                });
            } else {
                audioPlayer.pause();
                isPlaying = false;
                updatePlayPauseButton();
            }
            saveLastPlayedState(); // Oynat/duraklat durumunda da kaydet
        });

        // İlerleme çubuğu değiştiğinde
        progressBar.addEventListener('input', () => {
            const seekTime = (audioPlayer.duration / 100) * progressBar.value;
            audioPlayer.currentTime = seekTime;
            saveLastPlayedState(); // Kullanıcı manuel olarak ilerlemeyi değiştirdiğinde kaydet
        });

        // Oynatma hızı değiştiğinde
        playbackSpeedInput.addEventListener('input', (event) => {
            playbackSpeed = parseFloat(event.target.value);
            speedValueSpan.textContent = playbackSpeed.toFixed(1); // Hızı güncel olarak göster
            audioPlayer.playbackRate = playbackSpeed;
        });

        // Ses bittiğinde bir sonraki konuyu otomatik oynat
        audio.addEventListener('ended', () => {
            console.log('Ses bitti, bir sonraki konuya geçiliyor...');
            markTopicAsCompleted(); // Mevcut konuyu tamamlandı olarak işaretle
            saveLastPlayedState(); // Son durumu kaydet

            if (selectedBook && selectedTopic) {
                const currentTopicIndex = selectedBook.topics.findIndex(topic => topic.id === selectedTopic.id);

                // Bir sonraki konunun olup olmadığını kontrol et
                if (currentTopicIndex !== -1 && currentTopicIndex < selectedBook.topics.length - 1) {
                    const nextTopic = selectedBook.topics[currentTopicIndex + 1];
                    // Bir sonraki konuyu oynat
                    playTopic(nextTopic.id);
                } else {
                    console.log('Kitaptaki tüm konular bitti.');
                }
            }
        });

        // Audio olayları
        audioPlayer.addEventListener('loadedmetadata', () => {
            durationSpan.textContent = formatTime(audioPlayer.duration);
            audioPlayer.playbackRate = playbackSpeed; // Yükleme sonrası hızı ayarla
        });

        audioPlayer.addEventListener('timeupdate', () => {
            const progress = (audioPlayer.currentTime / audioPlayer.duration) * 100;
            progressBar.value = progress || 0;
            currentTimeSpan.textContent = formatTime(audioPlayer.currentTime);
            // İlerleme çubuğunun dolgu rengini güncelle
            progressBar.style.setProperty('--progress', progress + '%');

            // Her 5 saniyede bir veya belirli aralıklarla oynatma konumunu kaydet
            // Bu, çok sık yazmayı önlemek için basit bir kısıtlamadır.
            if (Math.floor(audioPlayer.currentTime) % 5 === 0) {
                saveLastPlayedState();
            }
        });

        audioPlayer.addEventListener('ended', () => {
            isPlaying = false;
            updatePlayPauseButton();
            progressBar.value = 0;
            currentTimeSpan.textContent = '00:00';
            progressBar.style.setProperty('--progress', '0%');

            // Mevcut konuyu tamamlanmış olarak işaretle
            if (selectedBook && currentTopic) {
                const bookId = selectedBook.id;
                const topicId = currentTopic.id;

                if (!bookProgressData[bookId]) {
                    bookProgressData[bookId] = { completedTopics: new Set(), listenCount: 0 };
                }
                bookProgressData[bookId].completedTopics.add(topicId);

                // Tüm konular tamamlandıysa, dinleme sayısını artır ve ilerlemeyi sıfırla
                if (bookProgressData[bookId].completedTopics.size === selectedBook.topics.length) {
                    bookProgressData[bookId].listenCount++;
                    bookProgressData[bookId].completedTopics.clear(); // Sonraki tamamlanma için sıfırla
                }
                saveProgressData(); // Verileri kaydet
            }

            const currentTopicIndex = selectedBook.topics.findIndex(
                topic => topic.id === currentTopic.id
            );
            const nextTopicIndex = currentTopicIndex + 1;

            if (nextTopicIndex < selectedBook.topics.length) {
                // Sonraki konuyu yükle ve otomatik oynat
                loadTopic(selectedBook.topics[nextTopicIndex], true);
            } else {
                console.log("Tüm konular bitti. Kitap tamamlandı.");
                // İsteğe bağlı: Tüm kitapların bittiğine dair özel bir mesaj gösterebiliriz.
            }
            updateDisplay(); // Kitap ilerlemesini güncelle
            saveLastPlayedState(); // Konu bittiğinde de son durumu kaydet
        });

        // Tema değiştirme düğmesi tıklaması
        themeToggleBtn.addEventListener('click', () => {
            let currentTheme = localStorage.getItem('theme') || 'dark'; // Mevcut temayı al
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            applyTheme(newTheme);
        });

        // İlerleme Sıfırla düğmesi tıklaması
        resetProgressBtn.addEventListener('click', () => {
            if (selectedBook && bookProgressData[selectedBook.id]) {
                // Seçili kitabın ilerlemesini sıfırla
                bookProgressData[selectedBook.id].completedTopics.clear();
                bookProgressData[selectedBook.id].listenCount = 0;
                saveProgressData(); // Güncellenmiş veriyi kaydet
                updateDisplay(); // UI'ı güncelle
                console.log(`${selectedBook.title} kitabının ilerlemesi sıfırlandı.`);
                
                // İlerleme sıfırlandığında son oynatılan durumu da temizle
                localStorage.removeItem('lastPlayedBookId');
                localStorage.removeItem('lastPlayedTopicId');
                localStorage.removeItem('lastPlayedTime');
            }
        });

        // Tarayıcı kapatıldığında veya sayfa yenilendiğinde son oynatma durumunu kaydet
        window.addEventListener('beforeunload', saveLastPlayedState);
    </script>
</body>
</html>
